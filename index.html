<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IOC Theo dÃµi Nhiá»‡m vá»¥</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body{background:#071028;color:white;font-family:system-ui}
.card{background:#0f1c3f;border:1px solid #1e3a8a}
</style>
</head>

<body class="p-6">

<!-- HEADER -->
<h1 class="text-3xl font-bold text-yellow-300 mb-8">
TRUNG TÃ‚M ÄIá»€U HÃ€NH NHIá»†M Vá»¤ KH,CN â€“ ÄMST
</h1>

<!-- KPI ROW -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10" id="kpis"></div>

<!-- MAIN DASHBOARD -->
<div class="grid lg:grid-cols-3 gap-10 mb-12">

<!-- DONUT -->
<div class="card rounded-xl p-6 text-center">
<h2 class="text-lg mb-6 text-yellow-200 font-bold">Tá»”NG THá»‚ TIáº¾N Äá»˜</h2>

<div class="relative w-64 h-64 mx-auto">
<div id="donut" class="w-64 h-64 rounded-full"></div>

<div class="absolute inset-0 flex flex-col justify-center items-center">
<div id="percent" class="text-3xl font-bold"></div>
<div class="text-sm">HoÃ n thÃ nh</div>
</div>
</div>

<div class="mt-6 space-y-2 text-left text-sm">
<div>ğŸ”´ ChÆ°a thá»±c hiá»‡n: <b id="a"></b></div>
<div>ğŸŸ¡ Äang thá»±c hiá»‡n: <b id="b"></b></div>
<div>ğŸŸ¢ ÄÃ£ xong: <b id="c"></b></div>
</div>
</div>

<!-- PROGRESS BY SOURCE -->
<div class="card rounded-xl p-6 col-span-2">
<h2 class="text-lg mb-6 text-yellow-200 font-bold">
TIáº¾N Äá»˜ THEO NGUá»’N GIAO
</h2>
<div id="bars"></div>
</div>

</div>

<!-- ALERT BOX -->
<div id="alerts" class="mb-10"></div>

<!-- TABLE -->
<div class="card rounded-xl p-6">
<h2 class="text-lg mb-6 text-yellow-200 font-bold">
DANH SÃCH NHIá»†M Vá»¤
</h2>

<table class="w-full text-sm">
<thead class="bg-yellow-400 text-black">
<tr>
<th>NhÃ³m</th>
<th>Nhiá»‡m vá»¥</th>
<th>Háº¡n</th>
<th>Tiáº¿n Ä‘á»™</th>
<th>Tráº¡ng thÃ¡i</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>
</div>

<script>

/* ================= DATA ================= */

const tasks=[
{g:"Trung Æ°Æ¡ng",t:"Triá»ƒn khai NQ Trung Æ°Æ¡ng vá» KH,CN",d:"2026-03-01"},
{g:"Trung Æ°Æ¡ng",t:"XÃ¢y dá»±ng há»‡ sinh thÃ¡i Ä‘á»•i má»›i sÃ¡ng táº¡o",d:"2027-06-01"},
{g:"Tá»‰nh á»§y",t:"Káº¿ hoáº¡ch chiáº¿n lÆ°á»£c KH,CN",d:"2026-01-01"},
{g:"Tá»‰nh á»§y",t:"Nghá»‹ quyáº¿t Ä‘á»™t phÃ¡ cÃ´ng nghá»‡",d:"2026-05-01"},
{g:"UBND",t:"ThÃ nh láº­p Trung tÃ¢m ÄMST",d:"2026-03-30"},
{g:"UBND",t:"Quá»¹ phÃ¡t triá»ƒn KH,CN",d:"2026-06-30"},
{g:"Sá»Ÿ",t:"Triá»ƒn khai chuyá»ƒn Ä‘á»•i sá»‘ doanh nghiá»‡p",d:"2026-12-30"},
{g:"Sá»Ÿ",t:"XÃ¢y dá»±ng cÆ¡ sá»Ÿ dá»¯ liá»‡u ngÃ nh",d:"2026-10-01"}
];

/* ================= STORAGE ================= */

function get(i){
return localStorage.getItem("p"+i)||"ChÆ°a";
}
function set(i,v){
localStorage.setItem("p"+i,v);
render();
}

/* ================= STATUS ================= */

function status(d,p){
const now=new Date();
const x=new Date(d);

if(p==="Xong") return["ÄÃ£ hoÃ n thÃ nh","bg-green-500"];
if(now>x) return["QuÃ¡ háº¡n","bg-red-500"];
return["ChÆ°a Ä‘áº¿n háº¡n","bg-yellow-400 text-black"];
}

/* ================= RENDER ================= */

function render(){

let A=0,B=0,C=0;
let tableHTML="";
let source={};

tasks.forEach((task,i)=>{

const p=get(i);
if(p==="ChÆ°a")A++;
if(p==="Äang")B++;
if(p==="Xong")C++;

if(!source[task.g])source[task.g]={t:0,d:0};
source[task.g].t++;
if(p==="Xong")source[task.g].d++;

const st=status(task.d,p);

tableHTML+=`
<tr class="border-b border-blue-900">
<td>${task.g}</td>
<td>${task.t}</td>
<td>${task.d}</td>

<td>
<select onchange="set(${i},this.value)" class="text-black">
<option ${p==="ChÆ°a"?"selected":""}>ChÆ°a</option>
<option ${p==="Äang"?"selected":""}>Äang</option>
<option ${p==="Xong"?"selected":""}>Xong</option>
</select>
</td>

<td class="${st[1]} text-center">${st[0]}</td>
</tr>`;
});

document.getElementById("table").innerHTML=tableHTML;

/* KPI */
document.getElementById("kpis").innerHTML=`
<div class="card p-4 text-center">Tá»•ng nhiá»‡m vá»¥<br><b>${tasks.length}</b></div>
<div class="card p-4 text-center">QuÃ¡ háº¡n<br><b>${A}</b></div>
<div class="card p-4 text-center">Äang thá»±c hiá»‡n<br><b>${B}</b></div>
<div class="card p-4 text-center">HoÃ n thÃ nh<br><b>${C}</b></div>
`;

/* DONUT */
const total=A+B+C||1;
const pC=Math.round(C/total*100);
const pA=A/total*100;
const pB=B/total*100;

document.getElementById("donut").style.background=
`conic-gradient(
#ef4444 0% ${pA}%,
#facc15 ${pA}% ${pA+pB}%,
#22c55e ${pA+pB}% 100%
)`;

document.getElementById("percent").innerText=pC+"%";
document.getElementById("a").innerText=A;
document.getElementById("b").innerText=B;
document.getElementById("c").innerText=C;

/* BARS */
let barsHTML="";
Object.keys(source).forEach(k=>{
const pct=Math.round(source[k].d/source[k].t*100);

barsHTML+=`
<div class="mb-4">
<div class="flex justify-between text-sm mb-1">
<span>${k}</span>
<span>${pct}%</span>
</div>
<div class="w-full bg-gray-700 h-3 rounded">
<div class="bg-green-400 h-3 rounded" style="width:${pct}%"></div>
</div>
</div>`;
});

document.getElementById("bars").innerHTML=barsHTML;

/* ALERTS */
let alertHTML="";
if(A>0)alertHTML+=`<div class="bg-red-600 p-3 mb-2 rounded">â— ${A} nhiá»‡m vá»¥ quÃ¡ háº¡n</div>`;
if(B>0)alertHTML+=`<div class="bg-yellow-500 text-black p-3 rounded">âš  ${B} nhiá»‡m vá»¥ Ä‘ang thá»±c hiá»‡n</div>`;

document.getElementById("alerts").innerHTML=alertHTML;
}

render();
</script>
</body>
</html>
