<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Theo dÃµi Nhiá»‡m vá»¥</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body { background:#0b132b; color:white; }
.card { background:#1c2541; }
.bad{background:#ef4444;}
.warn{background:#facc15;color:black;}
.good{background:#22c55e;}
</style>
</head>

<body class="p-8">

<h1 class="text-3xl font-bold mb-8 text-yellow-300">
THEO DÃ•I THá»°C HIá»†N NHIá»†M Vá»¤ KH,CN â€“ ÄMST
</h1>

<!-- LAYOUT SONG SONG -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-10">

<!-- ================= DASHBOARD TRÃ’N ================= -->
<div class="card p-6 text-center">

<h2 class="text-xl font-bold mb-6 text-yellow-200">Tá»”NG Há»¢P TIáº¾N Äá»˜</h2>

<div class="relative w-64 h-64 mx-auto">
<div id="donutChart" class="w-64 h-64 rounded-full"></div>

<div class="absolute inset-0 flex flex-col items-center justify-center">
<div id="percentDone" class="text-3xl font-bold"></div>
<div class="text-sm">ÄÃ£ hoÃ n thÃ nh</div>
</div>
</div>

<div class="mt-6 space-y-2 text-left">
<div>ğŸ”´ ChÆ°a thá»±c hiá»‡n: <b id="txtA"></b></div>
<div>ğŸŸ¡ Äang thá»±c hiá»‡n: <b id="txtB"></b></div>
<div>ğŸŸ¢ ÄÃ£ xong: <b id="txtC"></b></div>
</div>

</div>

<!-- ================= DANH SÃCH THEO NGUá»’N GIAO ================= -->
<div>

<h2 class="text-xl font-bold mb-4 text-yellow-200">PHÃ‚N THEO NGUá»’N GIAO NHIá»†M Vá»¤</h2>

<div id="taskGroups"></div>

</div>

</div>

<script>

/* ================= PHÃ‚N NHÃ“M NGUá»’N GIAO ================= */
const tasks = [

{group:"Trung Æ°Æ¡ng giao", task:"Triá»ƒn khai Nghá»‹ quyáº¿t 57-NQ/TW", deadline:"2026-12-31"},
{group:"Trung Æ°Æ¡ng giao", task:"PhÃ¡t triá»ƒn há»‡ sinh thÃ¡i Ä‘á»•i má»›i sÃ¡ng táº¡o quá»‘c gia", deadline:"2027-06-30"},

{group:"Tá»‰nh á»§y giao", task:"XÃ¢y dá»±ng Káº¿ hoáº¡ch thá»±c hiá»‡n Chiáº¿n lÆ°á»£c KH,CN", deadline:"2026-01-31"},
{group:"Tá»‰nh á»§y giao", task:"Ban hÃ nh Nghá»‹ quyáº¿t Ä‘á»™t phÃ¡ KH,CN", deadline:"2026-03-31"},

{group:"HÄND/UBND tá»‰nh giao", task:"ThÃ nh láº­p Trung tÃ¢m Äá»•i má»›i sÃ¡ng táº¡o", deadline:"2026-03-30"},
{group:"HÄND/UBND tá»‰nh giao", task:"ThÃ nh láº­p Quá»¹ phÃ¡t triá»ƒn KH,CN", deadline:"2026-06-30"}

];

/* ================= LÆ¯U TIáº¾N Äá»˜ ================= */
function getProgress(i){
return localStorage.getItem("p"+i) || "ChÆ°a thá»±c hiá»‡n";
}

function setProgress(i,val){
localStorage.setItem("p"+i,val);
render();
}

/* ================= TÃNH TRáº NG THÃI ================= */
function calcStatus(deadline,progress){
const now=new Date();
const d=new Date(deadline);

if(progress==="ÄÃ£ xong") return {txt:"ÄÃ£ hoÃ n thÃ nh",cls:"good"};
if(now>d) return {txt:"QuÃ¡ háº¡n",cls:"bad"};
return {txt:"ChÆ°a Ä‘áº¿n háº¡n",cls:"warn"};
}

/* ================= RENDER ================= */
function render(){

let countA=0,countB=0,countC=0;

const grouped={};
tasks.forEach((t,i)=>{
if(!grouped[t.group]) grouped[t.group]=[];
grouped[t.group].push({...t,index:i});
});

/* ==== render theo nhÃ³m ==== */
let html="";
Object.keys(grouped).forEach(g=>{

html+=`<div class="mb-6">
<h3 class="font-bold text-yellow-300 mb-2">${g}</h3>
<table class="w-full text-sm">
<tr class="bg-yellow-400 text-black">
<th>Nhiá»‡m vá»¥</th><th>Thá»i háº¡n</th><th>Tiáº¿n Ä‘á»™</th><th>Tráº¡ng thÃ¡i</th>
</tr>`;

grouped[g].forEach(t=>{
const progress=getProgress(t.index);
const status=calcStatus(t.deadline,progress);

if(progress==="ChÆ°a thá»±c hiá»‡n") countA++;
if(progress==="Äang thá»±c hiá»‡n") countB++;
if(progress==="ÄÃ£ xong") countC++;

html+=`
<tr class="card">
<td>${t.task}</td>
<td>${t.deadline}</td>
<td>
<select onchange="setProgress(${t.index},this.value)" class="text-black">
<option ${progress==="ChÆ°a thá»±c hiá»‡n"?"selected":""}>ChÆ°a thá»±c hiá»‡n</option>
<option ${progress==="Äang thá»±c hiá»‡n"?"selected":""}>Äang thá»±c hiá»‡n</option>
<option ${progress==="ÄÃ£ xong"?"selected":""}>ÄÃ£ xong</option>
</select>
</td>
<td class="${status.cls} text-center">${status.txt}</td>
</tr>`;
});

html+="</table></div>";
});

document.getElementById("taskGroups").innerHTML=html;

/* ==== váº½ dashboard ==== */
drawDonut(countA,countB,countC);
}

/* ================= BIá»‚U Äá»’ ================= */
function drawDonut(a,b,c){

const total=a+b+c || 1;
const pA=a/total*100;
const pB=b/total*100;
const pC=c/total*100;

document.getElementById("donutChart").style.background=
`conic-gradient(
#ef4444 0% ${pA}%,
#facc15 ${pA}% ${pA+pB}%,
#22c55e ${pA+pB}% 100%
)`;

document.getElementById("percentDone").innerText=Math.round(pC)+"%";
document.getElementById("txtA").innerText=a+" ("+Math.round(pA)+"%)";
document.getElementById("txtB").innerText=b+" ("+Math.round(pB)+"%)";
document.getElementById("txtC").innerText=c+" ("+Math.round(pC)+"%)";
}

render();

</script>
</body>
</html>
