<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOC Điều Hành KH&CN Tây Ninh - Siêu Rộng Nội Dung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            --primary: #1E40AF; 
            --bg-page: #F8FAFC;
            --bg-sidebar: #020617; 
            --sidebar-text: #94A3B8;
            --sidebar-active-bg: #1E40AF;
            --text-main: #0F172A;
            --border: #CBD5E1;
        }

        body {
            background-color: var(--bg-page);
            color: var(--text-main);
            font-family: 'Lexend', sans-serif;
            overflow: hidden;
        }

        .sidebar { width: 260px; background: var(--bg-sidebar); color: var(--sidebar-text); }

        .menu-item {
            padding: 10px 20px;
            margin: 4px 16px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }

        .active-item { 
            background: var(--sidebar-active-bg) !important; 
            color: white !important; 
            box-shadow: 0 4px 15px rgba(30, 64, 175, 0.4);
        }

        .compact-card {
            background: #FFFFFF;
            border: 1px solid var(--border);
            padding: 12px 16px;
            border-radius: 12px;
        }

        .card-total { background: linear-gradient(135deg, #1E40AF, #1E3A8A); color: white; border: none; }

        .task-table-container { background: #FFFFFF; border: 1px solid var(--border); border-radius: 12px; }

        /* HEADER BẢNG */
        thead.sticky th {
            color: white;
            font-weight: 800;
            background-color: #1e293b;
            text-transform: uppercase;
            font-size: 9.5px;
            padding: 12px 10px;
            letter-spacing: 0.05em;
        }

        /* TEXT TRONG BẢNG */
        .task-row td {
            font-size: 11px; 
            padding: 8px 10px;
            line-height: 1.4;
            border-bottom: 1px solid #f1f5f9;
        }

        /* Màu chữ xen kẽ cho từng dòng */
        .row-color-0 { color: #1e293b; }
        .row-color-1 { color: #1e40af; }
        .row-color-2 { color: #0369a1; }
        .row-color-3 { color: #4338ca; }
        .row-color-4 { color: #0f172a; }

        .task-row:hover { background-color: #f1f5f9; }

        .badge-step { padding: 4px 6px; border-radius: 4px; font-size: 8px; font-weight: 800; display: inline-block; width: 65px; }
        .badge-in-progress { background: #E0F2FE; color: #0369A1; border: 1px solid #BAe6FD; }
        .badge-done { background: #D1FAE5; color: #065F46; border: 1px solid #A7F3D0; }

        .tag { padding: 2px 5px; border-radius: 4px; font-size: 8.5px; font-weight: 800; }

        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="flex h-screen">

    <aside class="sidebar flex flex-col shrink-0">
        <div class="p-6">
            <h1 class="text-2xl font-black italic text-white">IOC <span class="text-blue-500">2026</span></h1>
            <p class="text-[10px] font-black text-blue-400 uppercase tracking-widest mt-1">Sở KH&CN Tây Ninh</p>
        </div>

        <nav class="flex-1 space-y-1">
            <button onclick="switchMode('ALL', this)" class="menu-item w-[calc(100%-32px)] active-item">Tất cả nhiệm vụ</button>
            <button onclick="switchMode('TU', this)" class="menu-item w-[calc(100%-32px)]">Tỉnh ủy giao (12)</button>
            <button onclick="switchMode('UB', this)" class="menu-item w-[calc(100%-32px)]">UBND Tỉnh giao (14)</button>
            <button onclick="switchMode('NQ24', this)" class="menu-item w-[calc(100%-32px)]">Nghị quyết 24 (18)</button>
            <button onclick="switchMode('SO', this)" class="menu-item w-[calc(100%-32px)]">Chuyên môn Sở</button>
        </nav>
        
        <div class="p-4 border-t border-slate-800">
            <div id="miniClock" class="text-xl font-bold font-mono text-blue-500 text-center">00:00:00</div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col overflow-hidden">
        <!-- Stats Bar -->
        <div class="p-4 grid grid-cols-12 gap-4 border-b border-slate-200 bg-white z-20">
            <div class="col-span-9 grid grid-cols-4 gap-4">
                <div class="compact-card card-total">
                    <div class="text-[9px] font-bold opacity-80 uppercase">Tổng số</div>
                    <div id="stat-total" class="text-2xl font-black">0</div>
                </div>
                <div class="compact-card border-l-4 border-amber-500">
                    <div class="text-[9px] font-bold text-slate-400 uppercase">Chưa xong</div>
                    <div id="stat-pending" class="text-2xl font-black text-amber-600">0</div>
                </div>
                <div class="compact-card border-l-4 border-emerald-500">
                    <div class="text-[9px] font-bold text-slate-400 uppercase">Đã xong</div>
                    <div id="stat-done" class="text-2xl font-black text-emerald-600">0</div>
                </div>
                <div class="compact-card border-l-4 border-blue-500">
                    <div class="text-[9px] font-bold text-slate-400 uppercase">Tỉ lệ (%)</div>
                    <div id="stat-percent" class="text-2xl font-black text-blue-700">0%</div>
                </div>
            </div>
            <div class="col-span-3 flex flex-col justify-center px-4 bg-blue-50 rounded-xl border border-blue-100">
                <div class="text-[9px] font-black text-blue-400 uppercase">Đang xem nhóm</div>
                <div id="currentCategoryLabel" class="text-sm font-bold text-blue-900 truncate uppercase">TẤT CẢ</div>
            </div>
        </div>

        <!-- Table Area -->
        <div class="flex-1 overflow-hidden flex flex-col p-4 gap-4 bg-slate-50">
            <div class="flex gap-3 shrink-0">
                <input type="text" id="search" placeholder="Tìm tên nhiệm vụ..." 
                       class="flex-1 h-9 px-4 rounded-xl text-xs font-semibold border border-slate-300 outline-none focus:ring-2 focus:ring-blue-500">
                <select id="unit" class="h-9 px-4 rounded-xl text-[10px] font-bold uppercase border border-slate-300 bg-white">
                    <option value="all">Tất cả Đơn vị</option>
                </select>
            </div>

            <div class="flex-1 overflow-y-auto custom-scroll task-table-container shadow-sm">
                <table class="w-full border-collapse table-fixed">
                    <thead class="sticky top-0 z-10">
                        <tr class="text-left">
                            <th class="p-2 w-8 text-center">#</th>
                            <th class="p-2 w-auto">Nội dung nhiệm vụ (Phần chính)</th> <!-- MỞ RỘNG TỐI ĐA -->
                            <th class="p-2 w-20">Tham mưu</th> 
                            <th class="p-2 w-14 text-center">Hạn</th> 
                            <th class="p-2 w-32">Tiến độ điều hành</th> 
                            <th class="p-2 w-20 text-center">Trạng thái</th>
                        </tr>
                    </thead>
                    <tbody id="taskTable"></tbody>
                </table>
            </div>
        </div>
    </main>

    <script>
        const steps = [
            "1. Đang soạn thảo",
            "2. Lấy ý kiến các phòng",
            "3. Trưởng phòng duyệt",
            "4. Lãnh đạo Sở duyệt",
            "5. Lấy ý kiến Sở Ngành",
            "6. Tổng hợp ý kiến",
            "7. Trình UBND Tỉnh",
            "8. Chờ VP UBND phản hồi",
            "9. Đã hoàn thành"
        ];

        const tasks = [
            {id: "TU-01", cat: "TU", g: "QLKH", t: "Kế hoạch thực hiện Chiến lược phát triển KH,CN & ĐMST đến năm 2030 theo Quyết định số 569/QĐ-TTg ngày 11/5/2022 của Thủ tướng Chính phủ", d: "01/26"},
            {id: "TU-02", cat: "TU", g: "CN&ĐMST", t: "Nghị quyết của Ban Chấp hành Đảng bộ tỉnh về đột phá phát triển khoa học công nghệ, đổi mới sáng tạo và chuyển đổi số; gắn với chuyển đổi xanh, kinh tế tuần hoàn trên địa bàn tỉnh Tây Ninh", d: "01/26"},
            {id: "TU-03", cat: "TU", g: "TC-KH", t: "Kế hoạch xây dựng, phát triển đội ngũ cán bộ KHCN đáp ứng yêu cầu thực hiện Nghị quyết số 57-NQ/TW của Bộ Chính trị về định hướng xây dựng và phát triển đội ngũ trí thức", d: "11/26"},
            {id: "TU-04", cat: "TU", g: "CN&ĐMST", t: "Xây dựng Đề án thu hút nhà đầu tư chiến lược vào các ngành công nghệ cao, các lĩnh vực trọng điểm của tỉnh đến năm 2030", d: "06/26"},
            {id: "TU-05", cat: "TU", g: "QLKH", t: "Chương trình phát triển nông nghiệp ứng dụng công nghệ cao gắn với tái cơ cấu ngành nông nghiệp tỉnh nhà theo hướng bền vững", d: "10/26"},
            {id: "TU-06", cat: "TU", g: "QLKH", t: "Tham mưu ý kiến Đề án đầu tư nâng cao năng lực Trạm nghiên cứu ứng dụng khoa học và công nghệ Đồng Tháp Mười giai đoạn 2025-2030", d: "07/26"},
            {id: "TU-07", cat: "TU", g: "Văn phòng", t: "Kế hoạch tổng thể nâng cao các chỉ số năng lực cạnh tranh cấp tỉnh PCI, chỉ số hiệu quả quản trị PAPI, chỉ số cải cách hành chính PAR INDEX", d: "07/26"},
            {id: "UB-01", cat: "UB", g: "CN&ĐMST", t: "Xây dựng và hoàn thiện Đề án thành lập Trung tâm Đổi mới sáng tạo tỉnh Tây Ninh nhằm thúc đẩy hệ sinh thái khởi nghiệp địa phương", d: "30/03/26"},
            {id: "UB-02", cat: "UB", g: "QLKH", t: "Tổ chức triển khai Kế hoạch phát triển tài sản trí tuệ tỉnh năm 2026 và hỗ trợ đăng ký bảo hộ nhãn hiệu đặc sản", d: "30/03/26"},
            {id: "UB-04", cat: "UB", g: "CN&ĐMST", t: "Nghiên cứu xây dựng Đề án thành lập Quỹ phát triển khoa học, công nghệ và đổi mới sáng tạo tỉnh Tây Ninh", d: "30/06/26"}
        ];

        // Thêm nhiệm vụ ảo để lấp đầy bảng
        for(let i=1; i<=30; i++) {
            tasks.push({ 
                id: `SO-${i<10?'0'+i:i}`, 
                cat: "SO", 
                g: "Văn phòng", 
                t: `Nhiệm vụ chuyên môn thường xuyên số ${i}: Kiểm tra, rà soát và đánh giá kết quả thực hiện các chỉ tiêu khoa học công nghệ tại các huyện, thị xã, thành phố trên địa bàn tỉnh trong năm 2026`, 
                d: "31/12/26" 
            });
        }

        let currentCat = 'ALL';

        function switchMode(cat, el) {
            currentCat = cat;
            document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active-item'));
            el.classList.add('active-item');
            document.getElementById('currentCategoryLabel').innerText = cat === 'ALL' ? 'TẤT CẢ' : cat;
            render();
        }

        function render() {
            const search = document.getElementById('search').value.toLowerCase();
            const unit = document.getElementById('unit').value;

            const filtered = tasks.filter(t => {
                const matchSearch = t.t.toLowerCase().includes(search) || t.id.toLowerCase().includes(search);
                const matchUnit = unit === 'all' || t.g === unit;
                const matchCat = currentCat === 'ALL' || t.cat === currentCat;
                return matchSearch && matchUnit && matchCat;
            });

            const doneCount = filtered.filter(t => localStorage.getItem('ioc_v20_'+t.id) === "9. Đã hoàn thành").length;
            const percent = filtered.length ? Math.round((doneCount/filtered.length)*100) : 0;

            document.getElementById('stat-total').innerText = filtered.length;
            document.getElementById('stat-pending').innerText = filtered.length - doneCount;
            document.getElementById('stat-done').innerText = doneCount;
            document.getElementById('stat-percent').innerText = percent + "%";

            let html = "";
            filtered.forEach((t, i) => {
                const step = localStorage.getItem('ioc_v20_'+t.id) || steps[0];
                const isDone = step === "9. Đã hoàn thành";
                const colorIdx = i % 5;
                
                let tagColor = "bg-slate-100 text-slate-600";
                if(t.cat === 'TU') tagColor = "bg-rose-100 text-rose-700";
                if(t.cat === 'UB') tagColor = "bg-emerald-100 text-emerald-700";
                if(t.cat === 'NQ24') tagColor = "bg-purple-100 text-purple-700";

                html += `
                    <tr class="task-row row-color-${colorIdx}">
                        <td class="text-center font-bold opacity-30">${i+1}</td>
                        <td class="break-words">
                            <div class="font-bold leading-snug mb-0.5">${t.t}</div>
                            <div class="flex gap-2 items-center">
                                <span class="tag ${tagColor}">${t.cat}</span>
                                <span class="text-[8px] font-mono opacity-50">${t.id}</span>
                            </div>
                        </td>
                        <td class="text-[9px] font-bold uppercase opacity-60">${t.g}</td>
                        <td class="text-center font-bold opacity-70">${t.d}</td>
                        <td>
                            <select onchange="save('${t.id}', this.value)" 
                                    class="w-full border border-slate-200 rounded px-1 py-0.5 text-[8.8px] font-medium outline-none ${isDone ? 'bg-emerald-50 text-emerald-700' : 'bg-white text-slate-700'}">
                                ${steps.map(s => `<option value="${s}" ${step === s ? 'selected' : ''}>${s}</option>`).join('')}
                            </select>
                        </td>
                        <td class="text-center">
                            <span class="badge-step ${isDone ? 'badge-done' : 'badge-in-progress'}">
                                ${isDone ? 'HOÀN THÀNH' : 'ĐANG XỬ LÝ'}
                            </span>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('taskTable').innerHTML = html;
        }

        function save(id, val) { localStorage.setItem('ioc_v20_'+id, val); render(); }
        setInterval(() => { document.getElementById('miniClock').innerText = new Date().toLocaleTimeString('vi-VN',{hour12:false}); }, 1000);
        
        const units = [...new Set(tasks.map(t => t.g))].sort();
        units.forEach(u => {
            const op = document.createElement('option'); op.value = u; op.innerText = u;
            document.getElementById('unit').appendChild(op);
        });

        document.getElementById('search').oninput = render;
        document.getElementById('unit').onchange = render;
        window.onload = render;
    </script>
</body>
</html>
